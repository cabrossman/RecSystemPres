<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>ALS boatsPV - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico"/>
<script>window.settings = {"enableSshKeyUI":false,"defaultInteractivePricePerDBU":0.4,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableClearStateFeature":false,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"maxCustomTags":45,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","compute_units":26.0,"number_of_ips":15,"local_disks":1,"reserved_compute_units":3.64,"memory_mb":62464,"num_cores":8,"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_ebs_volumes":false,"is_deprecated":false}],"default_node_type_id":"dev-tier-node"},"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"enableTableHandler":true,"maxEbsVolumesPerInstance":10,"isAdmin":true,"deltaProcessingBatchSize":1000,"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableCustomSpotPricingUIByTier":false,"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableMaxConcurrentRuns":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"clusters":true,"allowRunOnPendingClusters":true,"fileStoreBase":"FileStore","enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":false,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"perClusterAutoterminationEnabled":false,"enableNotebookCommandNumbers":true,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.11","displayName":"Spark 2.2 RC2 (Experimental, Scala 2.11)","packageLabel":"spark-image-56c2cdbb969d51a3f238b9ebee9e2029cfb61f8fa282b9941fd86da4268ddf18","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.10","displayName":"Spark 2.2 RC2 (Experimental, Scala 2.10)","packageLabel":"spark-image-3aa5d0a0bd86bb8f06ec7e40ccd7dd5892a04da6d27ba6ac426cddea97c61757","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":true}],"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"class-node":1,"m4.2xlarge":0.5,"r4.xlarge":1,"m4.4xlarge":0.5,"r4.16xlarge":8,"p2.8xlarge":16,"m4.10xlarge":0.5,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"c3.8xlarge":4,"r3.4xlarge":4,"i2.4xlarge":6,"m4.xlarge":0.5,"r4.8xlarge":8,"r4.large":0.5,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"memory-optimized":1,"m4.large":0.5,"p2.16xlarge":24,"c3.2xlarge":1,"c4.2xlarge":1,"i2.xlarge":1.5,"compute-optimized":1,"c4.4xlarge":2,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":0.5,"c4.8xlarge":4,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableEBSVolumesUI":false,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.45","accountsLimit":3,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"enableNotebookCommandMode":true,"disableS3TableImport":false,"deploymentMode":"production","useSpotForWorkers":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"enableCssTransitions":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":false,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":false,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true},"enableCustomSpotPricing":false,"enableMountAclsConfig":false,"defaultAutoterminationMin":180,"useDevTierHomePage":true,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","cloud":"AWS","disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"enableElasticDisk":false,"logfiles":"logfiles/","enableWebappSharding":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"2ea9484d5015af67bcd21b4075cad98c95f5c112","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"enableNewTableUI":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"useStandardTierUpgradeTooltips":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSpotClusterType":true,"enableSparkPackages":true,"dynamicSparkVersions":true,"enableClusterTagsUIByTier":false,"enableNotebookHistoryUI":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":false,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":true,"enableEBSVolumesUIByTier":false,"enableNewJobClusterEdit":false,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","maxAutoterminationMinutes":10000,"autoterminateClustersByDefault":true,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":true,"useOnDemandClustersByDefault":true,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":2819105119016378,"name":"ALS boatsPV","language":"python","commands":[{"version":"CommandV1","origId":2819105119016380,"guid":"3b2d93af-b4b1-4f9f-b3e8-36e25a42a5a3","subtype":"command","commandType":"auto","position":1.0,"command":"# Replace with your values\n#\n# NOTE: Set the access to this notebook appropriately to protect the security of your keys.\n# Or you can delete this cell after you run the mount command below once successfully.\nACCESS_KEY = \"YOUR_ACCESS_KEY_HERE\"\nSECRET_KEY = \"YOUR_SEC_KEY_HERE\"\nENCODED_SECRET_KEY = SECRET_KEY.replace(\"/\", \"%2F\")\nAWS_BUCKET_NAME = \"bizintel-tutorial\"\nMOUNT_NAME = \"als_pv\"\ndbutils.fs.mount(\"s3n://%s:%s@%s\" % (ACCESS_KEY, ENCODED_SECRET_KEY, AWS_BUCKET_NAME), \"/mnt/%s\" % MOUNT_NAME)","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"java.rmi.RemoteException: java.lang.IllegalArgumentException: requirement failed: Directory already mounted: /mnt/als_pv; nested exception is: ","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">ExecutionError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-2-49de2315b0eb&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      8</span> AWS_BUCKET_NAME <span class=\"ansiyellow\">=</span> <span class=\"ansiblue\">&quot;bizintel-tutorial&quot;</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      9</span> MOUNT_NAME <span class=\"ansiyellow\">=</span> <span class=\"ansiblue\">&quot;als_pv&quot;</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 10</span><span class=\"ansiyellow\"> </span>dbutils<span class=\"ansiyellow\">.</span>fs<span class=\"ansiyellow\">.</span>mount<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;s3n://%s:%s@%s&quot;</span> <span class=\"ansiyellow\">%</span> <span class=\"ansiyellow\">(</span>ACCESS_KEY<span class=\"ansiyellow\">,</span> ENCODED_SECRET_KEY<span class=\"ansiyellow\">,</span> AWS_BUCKET_NAME<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;/mnt/%s&quot;</span> <span class=\"ansiyellow\">%</span> MOUNT_NAME<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/tmp/1493854270151-0/dbutils.py</span> in <span class=\"ansicyan\">f_with_exception_handling</span><span class=\"ansiblue\">(*args, **kwargs)</span>\n<span class=\"ansigreen\">    161</span>                     <span class=\"ansigreen\">class</span> ExecutionError<span class=\"ansiyellow\">(</span>Exception<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    162</span>                         <span class=\"ansigreen\">pass</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 163</span><span class=\"ansiyellow\">                     </span><span class=\"ansigreen\">raise</span> ExecutionError<span class=\"ansiyellow\">(</span>str<span class=\"ansiyellow\">(</span>e<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    164</span>             <span class=\"ansigreen\">return</span> f_with_exception_handling<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    165</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">ExecutionError</span>: An error occurred while calling o113.mount.\n: java.rmi.RemoteException: java.lang.IllegalArgumentException: requirement failed: Directory already mounted: /mnt/als_pv; nested exception is: \n\tjava.lang.IllegalArgumentException: requirement failed: Directory already mounted: /mnt/als_pv\n\tat com.databricks.backend.daemon.data.client.DbfsClient.send0(DbfsClient.scala:86)\n\tat com.databricks.backend.daemon.data.client.DbfsClient.sendIdempotent(DbfsClient.scala:44)\n\tat com.databricks.backend.daemon.dbutils.DBUtilsCore.mount(DBUtilsCore.scala:322)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:280)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.IllegalArgumentException: requirement failed: Directory already mounted: /mnt/als_pv\n\tat scala.Predef$.require(Predef.scala:233)\n\tat com.databricks.backend.daemon.data.server.DefaultMetadataManager.insertMount(MetadataManager.scala:126)\n\tat com.databricks.backend.daemon.data.server.handler.MountHandler.receive(MountHandler.scala:39)\n\tat com.databricks.backend.daemon.data.server.session.SessionContext$$anonfun$queryHandlers$1.apply(SessionContext.scala:63)\n\tat com.databricks.backend.daemon.data.server.session.SessionContext$$anonfun$queryHandlers$1.apply(SessionContext.scala:62)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat com.databricks.backend.daemon.data.server.session.SessionContext.queryHandlers(SessionContext.scala:62)\n\tat com.databricks.backend.daemon.data.server.DbfsServerBackend$$anonfun$receive$1.applyOrElse(DbfsServerBackend.scala:245)\n\tat com.databricks.backend.daemon.data.server.DbfsServerBackend$$anonfun$receive$1.applyOrElse(DbfsServerBackend.scala:226)\n\tat com.databricks.rpc.ServerBackend$$anonfun$internalReceive$1.applyOrElse(ServerBackend.scala:41)\n\tat com.databricks.rpc.ServerBackend$$anonfun$internalReceive$1.applyOrElse(ServerBackend.scala:36)\n\tat scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:33)\n\tat com.databricks.rpc.ServerBackend$$anonfun$commonReceive$1.applyOrElse(ServerBackend.scala:56)\n\tat com.databricks.rpc.ServerBackend$$anonfun$commonReceive$1.applyOrElse(ServerBackend.scala:56)\n\tat scala.PartialFunction$OrElse.apply(PartialFunction.scala:162)\n\tat com.databricks.rpc.JettyServer$RequestManager$$anonfun$10.apply(JettyServer.scala:267)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.rpc.JettyServer$RequestManager.handleRPC(JettyServer.scala:267)\n\tat com.databricks.rpc.JettyServer$RequestManager.com$databricks$rpc$JettyServer$RequestManager$$handleRequestAndRespond(JettyServer.scala:202)\n\tat com.databricks.rpc.JettyServer$RequestManager$$anonfun$handleHttp$1.apply$mcV$sp(JettyServer.scala:145)\n\tat com.databricks.rpc.JettyServer$RequestManager$$anonfun$handleHttp$1.apply(JettyServer.scala:136)\n\tat com.databricks.rpc.JettyServer$RequestManager$$anonfun$handleHttp$1.apply(JettyServer.scala:136)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:173)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:168)\n\tat com.databricks.rpc.JettyServer$.withAttributionContext(JettyServer.scala:75)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:206)\n\tat com.databricks.rpc.JettyServer$.withAttributionTags(JettyServer.scala:75)\n\tat com.databricks.rpc.JettyServer$RequestManager.handleHttp(JettyServer.scala:135)\n\tat com.databricks.rpc.JettyServer$RequestManager.doGet(JettyServer.scala:90)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:687)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:790)\n\tat org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:845)\n\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:583)\n\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:513)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:134)\n\tat org.eclipse.jetty.server.Server.handle(Server.java:524)\n\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:319)\n\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:253)\n\tat org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:273)\n\tat org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:95)\n\tat org.eclipse.jetty.io.SelectChannelEndPoint$2.run(SelectChannelEndPoint.java:93)\n\tat org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.executeProduceConsume(ExecuteProduceConsume.java:303)\n\tat org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceConsume(ExecuteProduceConsume.java:148)\n\tat org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:136)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:671)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:589)\n\t... 1 more\n</div>","workflows":[],"startTime":1493854314500,"submitTime":1493854314500,"finishTime":1493854315686,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"909cfa96-8047-4b07-a084-57257ebbec0a"},{"version":"CommandV1","origId":127379081314564,"guid":"b9f2dda2-85a3-4eab-ad10-4ac049979273","subtype":"command","commandType":"auto","position":1.5,"command":"import urllib\nfrom pyspark.sql.types import *\nfrom pyspark.sql import SQLContext, Row\nfrom pyspark.sql import functions as F\nfrom pyspark.sql.window import Window\nfrom pyspark.sql.functions import col  ","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493900291230,"submitTime":1493900291210,"finishTime":1493900291304,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"061c2ac9-d4a2-42bc-9be7-4ffec407f03f"},{"version":"CommandV1","origId":2819105119016384,"guid":"c8650171-503b-4e0b-9fe3-ba6afc948030","subtype":"command","commandType":"auto","position":2.0,"command":"customSchema = StructType([\n                StructField('accept_language', StringType(),True), StructField('browser', StringType(),True), StructField('browser_height', StringType(),True), StructField('browser_width', StringType(),True),\n                StructField('c_color', StringType(),True), StructField('campaign', StringType(),True), StructField('carrier', StringType(),True), StructField('channel', StringType(),True), \n                StructField('click_action', StringType(),True), StructField('click_action_type', StringType(),True), StructField('click_context', StringType(),True), \n                StructField('click_context_type', StringType(),True), StructField('click_sourceid', StringType(),True), StructField('click_tag', StringType(),True), StructField('code_ver', StringType(),True), \n                StructField('color', StringType(),True), StructField('connection_type', StringType(),True), StructField('cookies', StringType(),True), StructField('country', StringType(),True), \n                StructField('ct_connect_type', StringType(),True), StructField('curr_factor', StringType(),True), StructField('curr_rate', StringType(),True), StructField('currency', StringType(),True), \n                StructField('cust_hit_time_gmt', StringType(),True), StructField('cust_visid', StringType(),True), StructField('daily_visitor', StringType(),True), StructField('date_time', StringType(),True), \n                StructField('domain', StringType(),True), StructField('duplicate_events', StringType(),True), StructField('duplicate_purchase', StringType(),True), StructField('duplicated_from', StringType(),True),\n                StructField('ef_id', StringType(),True), StructField('evar1', StringType(),True), StructField('evar2', StringType(),True), StructField('evar3', StringType(),True), \n                StructField('evar4', StringType(),True), StructField('evar5', StringType(),True), StructField('evar6', StringType(),True), StructField('evar7', StringType(),True), \n                StructField('evar8', StringType(),True), StructField('evar9', StringType(),True), StructField('evar10', StringType(),True), StructField('evar11', StringType(),True), \n                StructField('evar12', StringType(),True), \n                StructField('evar13', StringType(),True), StructField('evar14', StringType(),True), StructField('evar15', StringType(),True), StructField('evar16', StringType(),True), \n                StructField('evar17', StringType(),True), StructField('evar18', DoubleType(),True), StructField('evar19', DoubleType(),True), StructField('evar20', DoubleType(),True), \n                StructField('evar21', DoubleType(),True), StructField('evar22', DoubleType(),True), StructField('evar23', DoubleType(),True), StructField('evar24', StringType(),True),\n                StructField('evar25', StringType(),True), StructField('evar26', StringType(),True), StructField('evar27', StringType(),True), StructField('evar28', StringType(),True), \n                StructField('evar29', StringType(),True), StructField('evar30', StringType(),True), StructField('evar31', StringType(),True), StructField('evar32', StringType(),True), \n                StructField('evar33', StringType(),True), StructField('evar34', StringType(),True), StructField('evar35', StringType(),True), StructField('evar36', StringType(),True), \n                StructField('evar37', StringType(),True), StructField('evar38', StringType(),True), StructField('evar39', StringType(),True), StructField('evar40', StringType(),True), \n                StructField('evar41', StringType(),True), StructField('evar42', StringType(),True), StructField('evar43', DoubleType(),True), StructField('evar44', DoubleType(),True), \n                StructField('evar45', DoubleType(),True), StructField('evar46', StringType(),True), StructField('evar47', StringType(),True), StructField('evar48', StringType(),True), \n                StructField('evar49', StringType(),True), StructField('evar50', StringType(),True), StructField('evar51', StringType(),True), StructField('evar52', StringType(),True), \n                StructField('evar53', StringType(),True), StructField('evar54', StringType(),True), StructField('evar55', StringType(),True), StructField('evar56', StringType(),True), \n                StructField('evar57', StringType(),True), StructField('evar58', StringType(),True), StructField('evar59', StringType(),True), StructField('evar60', StringType(),True), \n                StructField('evar61', StringType(),True), StructField('evar62', StringType(),True), StructField('evar63', StringType(),True), StructField('evar64', StringType(),True), \n                StructField('evar65', StringType(),True), StructField('evar66', StringType(),True), StructField('evar67', StringType(),True), StructField('evar68', StringType(),True), \n                StructField('evar69', StringType(),True), StructField('evar70', StringType(),True), StructField('evar71', StringType(),True), StructField('evar72', StringType(),True), \n                StructField('evar73', StringType(),True), StructField('evar74', StringType(),True), StructField('evar75', StringType(),True), StructField('evar76', StringType(),True), \n                StructField('evar77', StringType(),True), StructField('evar78', StringType(),True), StructField('evar79', StringType(),True), StructField('evar80', StringType(),True), \n                StructField('evar81', StringType(),True), StructField('evar82', StringType(),True), StructField('evar83', StringType(),True), StructField('evar84', StringType(),True), \n                StructField('evar85', StringType(),True), StructField('evar86', StringType(),True), StructField('evar87', StringType(),True), StructField('evar88', StringType(),True), \n                StructField('evar89', StringType(),True), StructField('evar90', StringType(),True), StructField('evar91', StringType(),True), StructField('evar92', StringType(),True), \n                StructField('evar93', StringType(),True), StructField('evar94', StringType(),True), StructField('evar95', StringType(),True), StructField('evar96', StringType(),True), \n                StructField('evar97', StringType(),True), StructField('evar98', StringType(),True), StructField('evar99', StringType(),True), StructField('evar100', StringType(),True), \n                StructField('event_list', StringType(),True), StructField('exclude_hit', StringType(),True), StructField('first_hit_page_url', StringType(),True), \n                StructField('first_hit_pagename', StringType(),True), StructField('first_hit_referrer', StringType(),True), StructField('first_hit_time_gmt', StringType(),True), \n                StructField('geo_city', StringType(),True), StructField('geo_country', StringType(),True), StructField('geo_dma', StringType(),True), StructField('geo_region', StringType(),True), \n                StructField('geo_zip', StringType(),True), StructField('hier1', StringType(),True), StructField('hier2', StringType(),True), StructField('hier3', StringType(),True), \n                StructField('hier4', StringType(),True), StructField('hier5', StringType(),True), StructField('hit_source', StringType(),True), StructField('hit_time_gmt', StringType(),True), \n                StructField('hitid_high', StringType(),True), StructField('hitid_low', StringType(),True), StructField('homepage', StringType(),True), StructField('hourly_visitor', StringType(),True), \n                StructField('ip', StringType(),True), StructField('ip2', StringType(),True), StructField('j_jscript', StringType(),True), StructField('java_enabled', StringType(),True), \n                StructField('javascript', StringType(),True), StructField('language', StringType(),True), StructField('last_hit_time_gmt', StringType(),True), \n                StructField('last_purchase_num', StringType(),True), StructField('last_purchase_time_gmt', StringType(),True), StructField('mc_audiences', StringType(),True), \n                StructField('mcvisid', StringType(),True), StructField('mobile_id', StringType(),True), StructField('mobileaction', StringType(),True), StructField('mobileappid', StringType(),True), \n                StructField('mobilecampaigncontent', StringType(),True), StructField('mobilecampaignmedium', StringType(),True), StructField('mobilecampaignname', StringType(),True), \n                StructField('mobilecampaignsource', StringType(),True), StructField('mobilecampaignterm', StringType(),True), StructField('mobiledayofweek', StringType(),True), \n                StructField('mobiledayssincefirstuse', StringType(),True), StructField('mobiledayssincelastuse', StringType(),True), StructField('mobiledevice', StringType(),True), \n                StructField('mobilehourofday', StringType(),True), StructField('mobileinstalldate', StringType(),True), StructField('mobilelaunchnumber', StringType(),True), \n                StructField('mobileltv', StringType(),True), StructField('mobilemessageid', StringType(),True), StructField('mobilemessageonline', StringType(),True), \n                StructField('mobileosversion', StringType(),True), StructField('mobilepushoptin', StringType(),True), StructField('mobilepushpayloadid', StringType(),True), \n                StructField('mobileresolution', StringType(),True), StructField('monthly_visitor', StringType(),True), StructField('mvvar1', StringType(),True), StructField('mvvar2', StringType(),True), \n                StructField('mvvar3', StringType(),True), StructField('namespace', StringType(),True), StructField('new_visit', StringType(),True), StructField('os', StringType(),True), \n                StructField('p_plugins', StringType(),True), StructField('page_event', StringType(),True), StructField('page_event_var1', StringType(),True), StructField('page_event_var2', StringType(),True),\n                StructField('page_event_var3', StringType(),True), StructField('page_type', StringType(),True), StructField('page_url', StringType(),True), StructField('pagename', StringType(),True), \n                StructField('paid_search', StringType(),True), StructField('partner_plugins', StringType(),True), StructField('persistent_cookie', StringType(),True), StructField('plugins', StringType(),True),\n                StructField('pointofinterest', StringType(),True), StructField('pointofinterestdistance', StringType(),True), StructField('post_browser_height', StringType(),True), \n                StructField('post_browser_width', StringType(),True), StructField('post_campaign', StringType(),True), StructField('post_channel', StringType(),True), \n                StructField('post_cookies', StringType(),True), StructField('post_currency', StringType(),True), StructField('post_cust_hit_time_gmt', StringType(),True), \n                StructField('post_cust_visid', StringType(),True), StructField('post_ef_id', StringType(),True), StructField('post_evar1', StringType(),True), StructField('post_evar2', StringType(),True), \n                StructField('post_evar3', StringType(),True), StructField('post_evar4', StringType(),True), StructField('post_evar5', StringType(),True), StructField('post_evar6', StringType(),True), \n                StructField('post_evar7', StringType(),True), StructField('post_evar8', StringType(),True), StructField('post_evar9', StringType(),True), StructField('post_evar10', StringType(),True), \n                StructField('post_evar11', StringType(),True), StructField('post_evar12', StringType(),True), StructField('post_evar13', StringType(),True), StructField('post_evar14', StringType(),True), \n                StructField('post_evar15', StringType(),True), StructField('post_evar16', StringType(),True), StructField('post_evar17', StringType(),True), StructField('post_evar18', DoubleType(),True), \n                StructField('post_evar19', DoubleType(),True), StructField('post_evar20', DoubleType(),True), StructField('post_evar21', DoubleType(),True), StructField('post_evar22', DoubleType(),True), \n                StructField('post_evar23', DoubleType(),True), StructField('post_evar24', StringType(),True), StructField('post_evar25', StringType(),True), StructField('post_evar26', StringType(),True), \n                StructField('post_evar27', StringType(),True), StructField('post_evar28', StringType(),True), StructField('post_evar29', StringType(),True), StructField('post_evar30', StringType(),True), \n                StructField('post_evar31', StringType(),True), StructField('post_evar32', StringType(),True), StructField('post_evar33', StringType(),True), StructField('post_evar34', StringType(),True), \n                StructField('post_evar35', StringType(),True), StructField('post_evar36', StringType(),True), StructField('post_evar37', StringType(),True), StructField('post_evar38', StringType(),True), \n                StructField('post_evar39', StringType(),True), StructField('post_evar40', StringType(),True), StructField('post_evar41', StringType(),True), StructField('post_evar42', StringType(),True), \n                StructField('post_evar43', DoubleType(),True), StructField('post_evar44', DoubleType(),True), StructField('post_evar45', DoubleType(),True), StructField('post_evar46', StringType(),True), \n                StructField('post_evar47', StringType(),True), StructField('post_evar48', StringType(),True), StructField('post_evar49', StringType(),True), StructField('post_evar50', StringType(),True), \n                StructField('post_evar51', StringType(),True), StructField('post_evar52', StringType(),True), StructField('post_evar53', StringType(),True), StructField('post_evar54', StringType(),True), \n                StructField('post_evar55', StringType(),True), StructField('post_evar56', StringType(),True), StructField('post_evar57', StringType(),True), StructField('post_evar58', StringType(),True), \n                StructField('post_evar59', StringType(),True), StructField('post_evar60', StringType(),True), StructField('post_evar61', StringType(),True), StructField('post_evar62', StringType(),True), \n                StructField('post_evar63', StringType(),True), StructField('post_evar64', StringType(),True), StructField('post_evar65', StringType(),True), StructField('post_evar66', StringType(),True), \n                StructField('post_evar67', StringType(),True), StructField('post_evar68', StringType(),True), StructField('post_evar69', StringType(),True), StructField('post_evar70', StringType(),True), \n                StructField('post_evar71', StringType(),True), StructField('post_evar72', StringType(),True), StructField('post_evar73', StringType(),True), StructField('post_evar74', StringType(),True), \n                StructField('post_evar75', StringType(),True), StructField('post_evar76', StringType(),True), StructField('post_evar77', StringType(),True), StructField('post_evar78', StringType(),True), \n                StructField('post_evar79', StringType(),True), StructField('post_evar80', StringType(),True), StructField('post_evar81', StringType(),True), StructField('post_evar82', StringType(),True), \n                StructField('post_evar83', StringType(),True), StructField('post_evar84', StringType(),True), StructField('post_evar85', StringType(),True), StructField('post_evar86', StringType(),True), \n                StructField('post_evar87', StringType(),True), StructField('post_evar88', StringType(),True), StructField('post_evar89', StringType(),True), StructField('post_evar90', StringType(),True), \n                StructField('post_evar91', StringType(),True), StructField('post_evar92', StringType(),True), StructField('post_evar93', StringType(),True), StructField('post_evar94', StringType(),True), \n                StructField('post_evar95', StringType(),True), StructField('post_evar96', StringType(),True), StructField('post_evar97', StringType(),True), StructField('post_evar98', StringType(),True), \n                StructField('post_evar99', StringType(),True), StructField('post_evar100', StringType(),True), StructField('post_event_list', StringType(),True), StructField('post_hier1', StringType(),True), \n                StructField('post_hier2', StringType(),True), StructField('post_hier3', StringType(),True), StructField('post_hier4', StringType(),True), StructField('post_hier5', StringType(),True), \n                StructField('post_java_enabled', StringType(),True), StructField('post_keywords', StringType(),True), StructField('post_mc_audiences', StringType(),True), \n                StructField('post_mobileaction', StringType(),True), StructField('post_mobileappid', StringType(),True), StructField('post_mobilecampaigncontent', StringType(),True), \n                StructField('post_mobilecampaignmedium', StringType(),True), StructField('post_mobilecampaignname', StringType(),True), StructField('post_mobilecampaignsource', StringType(),True), \n                StructField('post_mobilecampaignterm', StringType(),True), StructField('post_mobiledayofweek', StringType(),True), StructField('post_mobiledayssincefirstuse', StringType(),True),\n                StructField('post_mobiledayssincelastuse', StringType(),True), StructField('post_mobiledevice', StringType(),True), StructField('post_mobilehourofday', StringType(),True), \n                StructField('post_mobileinstalldate', StringType(),True), StructField('post_mobilelaunchnumber', StringType(),True), StructField('post_mobileltv', StringType(),True), \n                StructField('post_mobilemessageid', StringType(),True), StructField('post_mobilemessageonline', StringType(),True), StructField('post_mobileosversion', StringType(),True), \n                StructField('post_mobilepushoptin', StringType(),True), StructField('post_mobilepushpayloadid', StringType(),True), StructField('post_mobileresolution', StringType(),True), \n                StructField('post_mvvar1', StringType(),True), StructField('post_mvvar2', StringType(),True), StructField('post_mvvar3', StringType(),True), StructField('post_page_event', StringType(),True), \n                StructField('post_page_event_var1', StringType(),True), StructField('post_page_event_var2', StringType(),True), StructField('post_page_event_var3', StringType(),True), \n                StructField('post_page_type', StringType(),True), StructField('post_page_url', StringType(),True), StructField('post_pagename', StringType(),True), \n                StructField('post_pagename_no_url', StringType(),True), StructField('post_partner_plugins', StringType(),True), StructField('post_persistent_cookie', StringType(),True), \n                StructField('post_pointofinterest', StringType(),True), StructField('post_pointofinterestdistance', StringType(),True), StructField('post_product_list', StringType(),True),\n                StructField('post_prop1', StringType(),True), StructField('post_prop2', StringType(),True), StructField('post_prop3', StringType(),True), StructField('post_prop4', StringType(),True), \n                StructField('post_prop5', StringType(),True), StructField('post_prop6', StringType(),True), StructField('post_prop7', StringType(),True), StructField('post_prop8', StringType(),True), \n                StructField('post_prop9', StringType(),True), StructField('post_prop10', StringType(),True), StructField('post_prop11', StringType(),True), StructField('post_prop12', StringType(),True), \n                StructField('post_prop13', StringType(),True), StructField('post_prop14', StringType(),True), StructField('post_prop15', StringType(),True), StructField('post_prop16', StringType(),True), \n                StructField('post_prop17', StringType(),True), StructField('post_prop18', StringType(),True), StructField('post_prop19', StringType(),True), StructField('post_prop20', StringType(),True), \n                StructField('post_prop21', StringType(),True), StructField('post_prop22', StringType(),True), StructField('post_prop23', StringType(),True), StructField('post_prop24', StringType(),True), \n                StructField('post_prop25', StringType(),True), StructField('post_prop26', StringType(),True), StructField('post_prop27', StringType(),True), StructField('post_prop28', StringType(),True), \n                StructField('post_prop29', StringType(),True), StructField('post_prop30', StringType(),True), StructField('post_prop31', StringType(),True), StructField('post_prop32', StringType(),True), \n                StructField('post_prop33', StringType(),True), StructField('post_prop34', StringType(),True), StructField('post_prop35', StringType(),True), StructField('post_prop36', StringType(),True), \n                StructField('post_prop37', StringType(),True), StructField('post_prop38', StringType(),True), StructField('post_prop39', StringType(),True), StructField('post_prop40', StringType(),True), \n                StructField('post_prop41', StringType(),True), StructField('post_prop42', StringType(),True), StructField('post_prop43', StringType(),True), StructField('post_prop44', StringType(),True), \n                StructField('post_prop45', StringType(),True), StructField('post_prop46', StringType(),True), StructField('post_prop47', StringType(),True), StructField('post_prop48', StringType(),True), \n                StructField('post_prop49', StringType(),True), StructField('post_prop50', StringType(),True), StructField('post_prop51', StringType(),True), StructField('post_prop52', StringType(),True), \n                StructField('post_prop53', StringType(),True), StructField('post_prop54', StringType(),True), StructField('post_prop55', StringType(),True), StructField('post_prop56', StringType(),True), \n                StructField('post_prop57', StringType(),True), StructField('post_prop58', StringType(),True), StructField('post_prop59', StringType(),True), StructField('post_prop60', StringType(),True), \n                StructField('post_prop61', StringType(),True), StructField('post_prop62', StringType(),True), StructField('post_prop63', StringType(),True), StructField('post_prop64', StringType(),True), \n                StructField('post_prop65', StringType(),True), StructField('post_prop66', StringType(),True), StructField('post_prop67', StringType(),True), StructField('post_prop68', StringType(),True), \n                StructField('post_prop69', StringType(),True), StructField('post_prop70', StringType(),True), StructField('post_prop71', StringType(),True), StructField('post_prop72', StringType(),True), \n                StructField('post_prop73', StringType(),True), StructField('post_prop74', StringType(),True), StructField('post_prop75', StringType(),True), StructField('post_purchaseid', StringType(),True), \n                StructField('post_referrer', StringType(),True), StructField('post_s_kwcid', StringType(),True), StructField('post_search_engine', StringType(),True), \n                StructField('post_socialaccountandappids', StringType(),True), StructField('post_socialassettrackingcode', StringType(),True), StructField('post_socialauthor', StringType(),True), \n                StructField('post_socialcontentprovider', StringType(),True), StructField('post_socialfbstories', StringType(),True), StructField('post_socialfbstorytellers', StringType(),True), \n                StructField('post_socialinteractioncount', StringType(),True), StructField('post_socialinteractiontype', StringType(),True), StructField('post_sociallanguage', StringType(),True), \n                StructField('post_sociallatlong', StringType(),True), StructField('post_sociallikeadds', StringType(),True), StructField('post_socialmentions', StringType(),True), \n                StructField('post_socialowneddefinitioninsighttype', StringType(),True), StructField('post_socialowneddefinitioninsightvalue', StringType(),True), \n                StructField('post_socialowneddefinitionmetric', StringType(),True), StructField('post_socialowneddefinitionpropertyvspost', StringType(),True), \n                StructField('post_socialownedpostids', StringType(),True), StructField('post_socialownedpropertyid', StringType(),True), StructField('post_socialownedpropertyname', StringType(),True),\n                StructField('post_socialownedpropertypropertyvsapp', StringType(),True), StructField('post_socialpageviews', StringType(),True), StructField('post_socialpostviews', StringType(),True), \n                StructField('post_socialpubcomments', StringType(),True), StructField('post_socialpubposts', StringType(),True), StructField('post_socialpubrecommends', StringType(),True), \n                StructField('post_socialpubsubscribers', StringType(),True), StructField('post_socialterm', StringType(),True), StructField('post_socialtotalsentiment', StringType(),True), \n                StructField('post_state', StringType(),True), StructField('post_survey', StringType(),True), StructField('post_t_time_info', StringType(),True), StructField('post_tnt', StringType(),True), \n                StructField('post_tnt_action', StringType(),True), StructField('post_transactionid', StringType(),True), StructField('post_video', StringType(),True), \n                StructField('post_videoad', StringType(),True), StructField('post_videoadinpod', StringType(),True), StructField('post_videoadplayername', StringType(),True), \n                StructField('post_videoadpod', StringType(),True), StructField('post_videochannel', StringType(),True), StructField('post_videochapter', StringType(),True), \n                StructField('post_videocontenttype', StringType(),True), StructField('post_videoplayername', StringType(),True), StructField('post_videoqoebitrateaverageevar', StringType(),True),\n                StructField('post_videoqoebitratechangecountevar', StringType(),True), StructField('post_videoqoebuffercountevar', StringType(),True), \n                StructField('post_videoqoebuffertimeevar', StringType(),True), StructField('post_videoqoedroppedframecountevar', StringType(),True), StructField('post_videoqoeerrorcountevar', StringType(),True),\n                StructField('post_videoqoetimetostartevar', StringType(),True), StructField('post_videosegment', StringType(),True), StructField('post_visid_high', StringType(),True), \n                StructField('post_visid_low', StringType(),True), StructField('post_visid_type', StringType(),True), StructField('post_zip', StringType(),True), StructField('prev_page', StringType(),True), \n                StructField('product_list', StringType(),True), StructField('product_merchandising', StringType(),True), StructField('prop1', StringType(),True), StructField('prop2', StringType(),True), \n                StructField('prop3', StringType(),True), StructField('prop4', StringType(),True), StructField('prop5', StringType(),True), StructField('prop6', StringType(),True), \n                StructField('prop7', StringType(),True), StructField('prop8', StringType(),True), StructField('prop9', StringType(),True), StructField('prop10', StringType(),True), \n                StructField('prop11', StringType(),True), StructField('prop12', StringType(),True), StructField('prop13', StringType(),True), StructField('prop14', StringType(),True), \n                StructField('prop15', StringType(),True), StructField('prop16', StringType(),True), StructField('prop17', StringType(),True), StructField('prop18', StringType(),True), \n                StructField('prop19', StringType(),True), StructField('prop20', StringType(),True), StructField('prop21', StringType(),True), StructField('prop22', StringType(),True), \n                StructField('prop23', StringType(),True), StructField('prop24', StringType(),True), StructField('prop25', StringType(),True), StructField('prop26', StringType(),True), \n                StructField('prop27', StringType(),True), StructField('prop28', StringType(),True), StructField('prop29', StringType(),True), StructField('prop30', StringType(),True), \n                StructField('prop31', StringType(),True), StructField('prop32', StringType(),True), StructField('prop33', StringType(),True), StructField('prop34', StringType(),True), \n                StructField('prop35', StringType(),True), StructField('prop36', StringType(),True), StructField('prop37', StringType(),True), StructField('prop38', StringType(),True), \n                StructField('prop39', StringType(),True), StructField('prop40', StringType(),True), StructField('prop41', StringType(),True), StructField('prop42', StringType(),True), \n                StructField('prop43', StringType(),True), StructField('prop44', StringType(),True), StructField('prop45', StringType(),True), StructField('prop46', StringType(),True), \n                StructField('prop47', StringType(),True), StructField('prop48', StringType(),True), StructField('prop49', StringType(),True), StructField('prop50', StringType(),True), \n                StructField('prop51', StringType(),True), StructField('prop52', StringType(),True), StructField('prop53', StringType(),True), StructField('prop54', StringType(),True), \n                StructField('prop55', StringType(),True), StructField('prop56', StringType(),True), StructField('prop57', StringType(),True), StructField('prop58', StringType(),True), \n                StructField('prop59', StringType(),True), StructField('prop60', StringType(),True), StructField('prop61', StringType(),True), StructField('prop62', StringType(),True), \n                StructField('prop63', StringType(),True), StructField('prop64', StringType(),True), StructField('prop65', StringType(),True), StructField('prop66', StringType(),True), \n                StructField('prop67', StringType(),True), StructField('prop68', StringType(),True), StructField('prop69', StringType(),True), StructField('prop70', StringType(),True), \n                StructField('prop71', StringType(),True), StructField('prop72', StringType(),True), StructField('prop73', StringType(),True), StructField('prop74', StringType(),True), \n                StructField('prop75', StringType(),True), StructField('purchaseid', StringType(),True), StructField('quarterly_visitor', StringType(),True), StructField('ref_domain', StringType(),True), \n                StructField('ref_type', StringType(),True), StructField('referrer', StringType(),True), StructField('resolution', StringType(),True), StructField('s_kwcid', StringType(),True), \n                StructField('s_resolution', StringType(),True), StructField('sampled_hit', StringType(),True), StructField('search_engine', StringType(),True), \n                StructField('search_page_num', StringType(),True), StructField('secondary_hit', StringType(),True), StructField('service', StringType(),True), \n                StructField('socialaccountandappids', StringType(),True), StructField('socialassettrackingcode', StringType(),True), StructField('socialauthor', StringType(),True), \n                StructField('socialcontentprovider', StringType(),True), StructField('socialfbstories', StringType(),True), StructField('socialfbstorytellers', StringType(),True), \n                StructField('socialinteractioncount', StringType(),True), StructField('socialinteractiontype', StringType(),True), StructField('sociallanguage', StringType(),True), \n                StructField('sociallatlong', StringType(),True), StructField('sociallikeadds', StringType(),True), StructField('socialmentions', StringType(),True), \n                StructField('socialowneddefinitioninsighttype', StringType(),True), StructField('socialowneddefinitioninsightvalue', StringType(),True), StructField('socialowneddefinitionmetric', StringType(),True),\n                StructField('socialowneddefinitionpropertyvspost', StringType(),True), StructField('socialownedpostids', StringType(),True), StructField('socialownedpropertyid', StringType(),True), \n                StructField('socialownedpropertyname', StringType(),True), StructField('socialownedpropertypropertyvsapp', StringType(),True), StructField('socialpageviews', StringType(),True), \n                StructField('socialpostviews', StringType(),True), StructField('socialpubcomments', StringType(),True), StructField('socialpubposts', StringType(),True), \n                StructField('socialpubrecommends', StringType(),True), StructField('socialpubsubscribers', StringType(),True), StructField('socialterm', StringType(),True), \n                StructField('socialtotalsentiment', StringType(),True), StructField('sourceid', StringType(),True), StructField('state', StringType(),True), StructField('stats_server', StringType(),True), \n                StructField('t_time_info', StringType(),True), StructField('tnt', StringType(),True), StructField('tnt_action', StringType(),True), StructField('tnt_post_vista', StringType(),True), \n                StructField('transactionid', StringType(),True), StructField('truncated_hit', StringType(),True), StructField('ua_color', StringType(),True), StructField('ua_os', StringType(),True), \n                StructField('ua_pixels', StringType(),True), StructField('user_agent', StringType(),True), StructField('user_hash', StringType(),True), StructField('user_server', StringType(),True), \n                StructField('userid', StringType(),True), StructField('username', StringType(),True), StructField('va_closer_detail', StringType(),True), StructField('va_closer_id', StringType(),True), \n                StructField('va_finder_detail', StringType(),True), StructField('va_finder_id', StringType(),True), StructField('va_instance_event', StringType(),True), \n                StructField('va_new_engagement', StringType(),True), StructField('video', StringType(),True), StructField('videoad', StringType(),True), StructField('videoadinpod', StringType(),True), \n                StructField('videoadplayername', StringType(),True), StructField('videoadpod', StringType(),True), StructField('videochannel', StringType(),True), StructField('videochapter', StringType(),True),\n                StructField('videocontenttype', StringType(),True), StructField('videoplayername', StringType(),True), StructField('videoqoebitrateaverageevar', StringType(),True), \n                StructField('videoqoebitratechangecountevar', StringType(),True), StructField('videoqoebuffercountevar', StringType(),True), StructField('videoqoebuffertimeevar', StringType(),True), \n                StructField('videoqoedroppedframecountevar', StringType(),True), StructField('videoqoeerrorcountevar', StringType(),True), StructField('videoqoetimetostartevar', StringType(),True), \n                StructField('videosegment', StringType(),True), StructField('visid_high', StringType(),True), StructField('visid_low', StringType(),True), StructField('visid_new', StringType(),True), \n                StructField('visid_timestamp', StringType(),True), StructField('visid_type', StringType(),True), StructField('visit_keywords', StringType(),True), StructField('visit_num', DoubleType(),True), \n                StructField('visit_page_num', DoubleType(),True), StructField('visit_referrer', StringType(),True), StructField('visit_search_engine', StringType(),True), \n                StructField('visit_start_page_url', StringType(),True), StructField('visit_start_pagename', StringType(),True), StructField('visit_start_time_gmt', StringType(),True), \n                StructField('weekly_visitor', StringType(),True), StructField('yearly_visitor', StringType(),True), StructField('zip', StringType(),True)])\n\t\t\t\t","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1493900304108,"submitTime":1493900304076,"finishTime":1493900308015,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b993582a-22df-467c-bf2f-af460d35ad64"},{"version":"CommandV1","origId":127379081314563,"guid":"147dbfaf-e48e-4e6d-94cf-173d30208224","subtype":"command","commandType":"auto","position":2.5,"command":"#can use wildcard to pull in multiple files, This pulls in all files for 20151101 (24 files total)\ndf_raw = spark.read.csv('/mnt/als_pv/01-demidas_20151101*.tsv.gz', header=False, schema=customSchema, sep = \"\\t\", mode=\"DROPMALFORMED\")\n\n\ncol_list = ['ip','post_evar3']\n\n#filter for columns of interest. PV by ip by IMT\ndf = df_raw[col_list].filter('post_evar3 is not null').filter('ip is not null').filter(\"post_evar3 != 'fsbo'\") \\\n.groupby(['ip','post_evar3']).count().selectExpr(\"ip as ip\", \"post_evar3 as IMT\",\"count as pv\")\n\nprint('count of rows ' + str(df.count()))\ndf.show()\ndf.cache()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">count of rows 481976\n+--------------+-------+---+\n|            ip|    IMT| pv|\n+--------------+-------+---+\n| 24.61.126.153|5407320|  3|\n|    80.7.5.243|4607534|  4|\n|   85.75.50.24|3882844|  5|\n|166.137.248.82|4510630|  7|\n| 24.34.154.117|5374496| 47|\n|  50.249.9.253|5274572|  3|\n| 107.77.105.25|5361593|  4|\n|   2.219.71.40|5381500|  3|\n|37.201.224.191|3899998|  8|\n| 148.74.27.235|3130052|  2|\n|98.221.208.187|5388718| 11|\n|   70.45.80.28|5154918|  7|\n|98.208.210.225|5416703|  5|\n|70.197.232.251|5115690|  3|\n|  70.208.72.50|4886649|  2|\n|  104.7.22.191| 526965|  7|\n| 72.80.108.196|4887094|  5|\n|  68.42.96.250|5359314| 10|\n| 67.83.124.179|4041714|  3|\n| 67.83.124.179|4506483| 10|\n+--------------+-------+---+\nonly showing top 20 rows\n\n<span class=\"ansired\">Out[</span><span class=\"ansired\">4</span><span class=\"ansired\">]: </span>DataFrame[ip: string, IMT: string, pv: bigint]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493900315744,"submitTime":1493900315734,"finishTime":1493900464040,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f85f7e2c-e9a8-4cbb-8492-30814cf06749"},{"version":"CommandV1","origId":1259652805737845,"guid":"5d724f8d-341f-4ae3-88b1-adbb4e314b82","subtype":"command","commandType":"auto","position":3.0,"command":"#create customer Id\nuserId_data = df.groupby('ip').count().select('ip',col('count').alias('tot_user_views'),F.row_number().over(Window.orderBy('ip')).alias('userId'))\nprint('count of rows ' + str(userId_data.count()))\nuserId_data.show()\nuserId_data.cache()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">count of rows 99238\n+-------------+--------------+------+\n|           ip|tot_user_views|userId|\n+-------------+--------------+------+\n|  1.0.236.136|            61|     1|\n|    1.0.236.2|             1|     2|\n| 1.10.195.134|             2|     3|\n|  1.10.251.45|             1|     4|\n| 1.114.11.218|             1|     5|\n| 1.120.139.14|             1|     6|\n|  1.120.97.42|            18|     7|\n|1.121.137.248|             1|     8|\n|1.121.141.200|             2|     9|\n|1.121.145.159|             2|    10|\n| 1.121.163.52|             1|    11|\n| 1.121.168.42|             5|    12|\n| 1.122.177.89|             1|    13|\n|1.122.241.243|             1|    14|\n|  1.122.54.15|             7|    15|\n| 1.122.95.197|             7|    16|\n|   1.123.1.97|             1|    17|\n|1.123.146.191|             3|    18|\n| 1.124.48.149|             3|    19|\n| 1.124.48.224|             1|    20|\n+-------------+--------------+------+\nonly showing top 20 rows\n\n<span class=\"ansired\">Out[</span><span class=\"ansired\">6</span><span class=\"ansired\">]: </span>DataFrame[ip: string, tot_user_views: bigint, userId: int]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: over() takes exactly 2 arguments (1 given)","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-27-eeb1c6ead148&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\">#create customer Id</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>custId_data <span class=\"ansiyellow\">=</span> df<span class=\"ansiyellow\">.</span>select<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;ip&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>select<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;ip&apos;</span><span class=\"ansiyellow\">,</span>F<span class=\"ansiyellow\">.</span>row_number<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>over<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>orderBy<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;ip&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>alias<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;custId&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> <span class=\"ansigreen\">print</span><span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;count of rows &apos;</span> <span class=\"ansiyellow\">+</span> str<span class=\"ansiyellow\">(</span>custId_data<span class=\"ansiyellow\">.</span>count<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> custId_data<span class=\"ansiyellow\">.</span>show<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">TypeError</span>: over() takes exactly 2 arguments (1 given)</div>","workflows":[],"startTime":1493900627271,"submitTime":1493900627261,"finishTime":1493900636939,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6089e12a-ba8a-47a2-affe-94605e52f0d0"},{"version":"CommandV1","origId":1259652805737846,"guid":"91c3480d-f5a9-4051-81f2-f851a7a5c182","subtype":"command","commandType":"auto","position":4.0,"command":"#create product Id\nprodId_data = df.groupby('IMT').count().select('IMT',col('count').alias('tot_prod_views'),F.row_number().over(Window.orderBy('IMT')).alias('prodId'))\nprint('count of rows ' + str(prodId_data.count()))\nprodId_data.show()\nprodId_data.cache()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">count of rows 122231\n+-------+--------------+------+\n|    IMT|tot_prod_views|prodId|\n+-------+--------------+------+\n|1000017|            14|     1|\n| 100002|             2|     2|\n|1000022|             2|     3|\n|1000058|             3|     4|\n| 100026|             1|     5|\n| 100027|             2|     6|\n| 100051|             4|     7|\n| 100052|             1|     8|\n|1000634|             3|     9|\n| 100085|             2|    10|\n| 100088|             1|    11|\n| 100095|             2|    12|\n| 100100|             2|    13|\n| 100102|             4|    14|\n| 100104|             2|    15|\n| 100105|             2|    16|\n| 100108|             2|    17|\n| 100110|             5|    18|\n| 100154|             2|    19|\n| 100168|             1|    20|\n+-------+--------------+------+\nonly showing top 20 rows\n\n<span class=\"ansired\">Out[</span><span class=\"ansired\">7</span><span class=\"ansired\">]: </span>DataFrame[IMT: string, tot_prod_views: bigint, prodId: int]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493900664381,"submitTime":1493900664372,"finishTime":1493900673989,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6d3b65b3-9f1b-4170-b08f-befa73f95cca"},{"version":"CommandV1","origId":1259652805737849,"guid":"7241c1aa-ae6e-4cc9-b018-f723122cdd93","subtype":"command","commandType":"auto","position":4.5,"command":"#join data\nratingIds = df.join(userId_data, 'ip').join(prodId_data,'IMT')\n#clear cache\ndf.unpersist()\nuserId_data.unpersist()\nprodId_data.unpersist()\n#cache new data\nratingIds.cache()\nratingIds.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------+--------------+---+--------------+------+--------------+------+\n|    IMT|            ip| pv|tot_user_views|userId|tot_prod_views|prodId|\n+-------+--------------+---+--------------+------+--------------+------+\n|5407320| 24.61.126.153|  3|            15| 36004|             4|108247|\n|4607534|    80.7.5.243|  4|            29| 81247|             1| 28142|\n|3882844|   85.75.50.24|  5|            26| 84834|             5| 10796|\n|4510630|166.137.248.82|  7|            59| 13790|             4| 23956|\n|5374496| 24.34.154.117| 47|            25| 35439|             7| 96033|\n|5274572|  50.249.9.253|  3|            13| 42013|             8| 83919|\n|5361593| 107.77.105.25|  4|            25|  4052|             9| 91184|\n|5381500|   2.219.71.40|  3|             4| 26875|             1| 98152|\n|3899998|37.201.224.191|  8|             9| 37490|            19| 11015|\n|3130052| 148.74.27.235|  2|            11| 11508|             2|  4063|\n|5388718|98.221.208.187| 11|            15| 95905|            27|101000|\n|5154918|   70.45.80.28|  7|            18| 62049|             8| 79669|\n|5416703|98.208.210.225|  5|             9| 95572|            19|111928|\n|5115690|70.197.232.251|  3|            19| 58578|            19| 70543|\n|4886649|  70.208.72.50|  2|             1| 59924|            20| 46034|\n| 526965|  104.7.22.191|  7|            68|  2443|             3| 83255|\n|4887094| 72.80.108.196|  5|            17| 68212|            51| 46115|\n|5359314|  68.42.96.250| 10|            21| 51938|             1| 90304|\n|4041714| 67.83.124.179|  3|             9| 49753|            16| 12838|\n|4506483| 67.83.124.179| 10|             9| 49753|             2| 23753|\n+-------+--------------+---+--------------+------+--------------+------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1493900712272,"submitTime":1493900712261,"finishTime":1493900910199,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0df12a51-a53a-480c-b4d0-491c8b766658"},{"version":"CommandV1","origId":1259652805737848,"guid":"07b6f708-49b5-4990-9fad-573f9ebc66b6","subtype":"command","commandType":"auto","position":6.0,"command":"from pyspark.ml.evaluation import RegressionEvaluator\nfrom pyspark.sql import Row\nfrom pyspark.ml.recommendation import ALS\n\n#split for testing\ntraining, validation, test = ratingIds.randomSplit([0.6, 0.2, 0.2])\n\nranks = [4, 8, 12]\nbest_rank = -1\nmin_rmse = 9999\n\n# Build the recommendation model using ALS on the training data\nfor r in ranks:\n  als = ALS(maxIter=5, regParam=0.01, implicitPrefs=True, userCol=\"userId\", itemCol=\"prodId\", ratingCol=\"pv\", rank = r)\n  model = als.fit(training)\n  predictions = model.transform(test)\n  #need to drop NaN caused by the difference in model and test -- needs full dataset\n  predictions = predictions.na.drop(subset=[\"prediction\"])\n  evaluator = RegressionEvaluator(metricName=\"rmse\", labelCol=\"pv\",predictionCol=\"prediction\")\n  rmse = evaluator.evaluate(predictions)\n  if rmse < min_rmse:\n    best_rank = r\n    min_rmse = rmse\n  print(\"RMSE: \" + str(rmse))\n  \nprint(\"the best rank: \" + str(best_rank))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">RMSE: 10.5707121923\nRMSE: 10.5667094767\nRMSE: 10.5648355798\nthe best rank: 12\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">IllegalArgumentException</span>: u&apos;Field &quot;count&quot; does not exist.&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">IllegalArgumentException</span>                  Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-9-a8093a03e5ea&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     18</span>   predictions <span class=\"ansiyellow\">=</span> predictions<span class=\"ansiyellow\">.</span>na<span class=\"ansiyellow\">.</span>drop<span class=\"ansiyellow\">(</span>subset<span class=\"ansiyellow\">=</span><span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&quot;prediction&quot;</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     19</span>   evaluator <span class=\"ansiyellow\">=</span> RegressionEvaluator<span class=\"ansiyellow\">(</span>metricName<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&quot;rmse&quot;</span><span class=\"ansiyellow\">,</span> labelCol<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&quot;count&quot;</span><span class=\"ansiyellow\">,</span>predictionCol<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&quot;prediction&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 20</span><span class=\"ansiyellow\">   </span>rmse <span class=\"ansiyellow\">=</span> evaluator<span class=\"ansiyellow\">.</span>evaluate<span class=\"ansiyellow\">(</span>predictions<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     21</span>   <span class=\"ansigreen\">if</span> rmse <span class=\"ansiyellow\">&lt;</span> min_rmse<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     22</span>     best_rank <span class=\"ansiyellow\">=</span> r<span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/evaluation.py</span> in <span class=\"ansicyan\">evaluate</span><span class=\"ansiblue\">(self, dataset, params)</span>\n<span class=\"ansigreen\">     67</span>                 <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>copy<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>_evaluate<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_evaluate<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>             <span class=\"ansigreen\">raise</span> ValueError<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;Params must be a param map but got %s.&quot;</span> <span class=\"ansiyellow\">%</span> type<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/evaluation.py</span> in <span class=\"ansicyan\">_evaluate</span><span class=\"ansiblue\">(self, dataset)</span>\n<span class=\"ansigreen\">     97</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">     98</span>         self<span class=\"ansiyellow\">.</span>_transfer_params_to_java<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 99</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_java_obj<span class=\"ansiyellow\">.</span>evaluate<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    100</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    101</span>     <span class=\"ansigreen\">def</span> isLargerBetter<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     77</span>                 <span class=\"ansigreen\">raise</span> QueryExecutionException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     78</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;java.lang.IllegalArgumentException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 79</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> IllegalArgumentException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     80</span>             <span class=\"ansigreen\">raise</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     81</span>     <span class=\"ansigreen\">return</span> deco<span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">IllegalArgumentException</span>: u&apos;Field &quot;count&quot; does not exist.&apos;</div>","workflows":[],"startTime":1493901215068,"submitTime":1493901215058,"finishTime":1493901267630,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f1ca0a42-ce12-42b5-9470-1d05ec376a2a"},{"version":"CommandV1","origId":1259652805737850,"guid":"0b970ac2-7dad-4d52-b319-1a62ba2f09e0","subtype":"command","commandType":"auto","position":7.0,"command":"# Evaluate the model by computing the RMSE on the test data\nals = ALS(maxIter=5, regParam=0.01, implicitPrefs=True, userCol=\"userId\", itemCol=\"prodId\", ratingCol=\"pv\", rank = best_rank)\nmodel = als.fit(training)\npredictions = model.transform(test)\n#need to drop NaN caused by the difference in model and test -- needs full dataset\npredictions = predictions.na.drop(subset=[\"prediction\"])\nevaluator = RegressionEvaluator(metricName=\"rmse\", labelCol=\"pv\",predictionCol=\"prediction\")\nrmse = evaluator.evaluate(predictions)\nprint(\"Root-mean-square error = \" + str(rmse))\npredictions.describe().show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Root-mean-square error = 10.5648355798\n+-------+--------------------+------------+-----------------+------------------+-----------------+------------------+------------------+--------------------+\n|summary|                 IMT|          ip|               pv|    tot_user_views|           userId|    tot_prod_views|            prodId|          prediction|\n+-------+--------------------+------------+-----------------+------------------+-----------------+------------------+------------------+--------------------+\n|  count|               72619|       72619|            72619|             72619|            72619|             72619|             72619|               72619|\n|   mean|1.4465447757539453E7|        null|6.945716685715859| 20.44941406518955|49051.66427518969| 11.97537834451039| 63472.74134868285|0.008298444161954466|\n| stddev|  9.81657528094103E8|        null|7.972100141468849|24.884755974952128|28950.97420604048|23.258730563362583|34920.303180527466| 0.03517438813160969|\n|    min|             1000017| 1.0.236.136|                1|                 2|                1|                 2|                 1|         -0.37726343|\n|    max|             finance|99.99.55.118|              832|               258|            99238|               521|            122226|          0.81120414|\n+-------+--------------------+------------+-----------------+------------------+-----------------+------------------+------------------+--------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493901365733,"submitTime":1493901365723,"finishTime":1493901395179,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"91c4a1b2-e9d6-4277-b821-e8515fe84869"},{"version":"CommandV1","origId":1259652805737851,"guid":"a64995c0-9ba6-4e98-b241-c6745b1a47ff","subtype":"command","commandType":"auto","position":8.0,"command":"#predictions with boats having more than 5 total views\nfrom pyspark.sql.functions import desc\npredictions_test = model.transform(test)\npredictions_test = predictions_test.na.drop(subset=[\"prediction\"]).filter('tot_prod_views >=5').sort(desc('prediction'))\npredictions_test.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------+--------------+---+--------------+------+--------------+------+----------+\n|    IMT|            ip| pv|tot_user_views|userId|tot_prod_views|prodId|prediction|\n+-------+--------------+---+--------------+------+--------------+------+----------+\n|4789457|96.232.170.184| 14|            46| 91927|            34| 36669|0.81120414|\n|4887094|184.160.242.28| 14|            31| 22509|            51| 46115| 0.7991085|\n|5140294| 66.87.117.147|  6|            13| 46878|           239| 75697| 0.7792025|\n|4860694|96.232.170.184| 18|            46| 91927|            33| 43266| 0.7516801|\n|5078169|  93.118.3.211| 11|           135| 89911|            69| 64958|0.74910575|\n|5078169|73.139.209.107| 15|            87| 68988|            69| 64958|0.74729586|\n|4501060|98.143.214.159| 10|           138| 94691|            35| 23472|0.74645525|\n|4887094|   24.54.6.163|  7|            71| 35869|            51| 46115|0.73941773|\n|4834582|91.157.228.143| 22|            41| 88774|            46| 40667|0.71936095|\n|5421363| 24.140.38.185| 30|           228| 33190|            24|113577|0.68883264|\n| 545492|64.246.131.210| 11|            85| 44484|            98|120351|0.68277466|\n|5155984|70.198.129.178| 13|            67| 58704|            41| 79996|0.67604256|\n| 545418| 76.186.168.28|  6|           157| 77560|            58|120350| 0.6694848|\n|4906092|  71.226.81.63| 18|            33| 64259|            48| 48462| 0.6646904|\n|5148950| 76.186.168.28| 10|           157| 77560|            21| 78024|0.66424745|\n|4344744|72.239.104.246| 16|            72| 67584|            55| 17848| 0.6601963|\n|3975371|98.143.214.159|  7|           138| 94691|            35| 11656| 0.6455762|\n|4377471| 89.142.194.58| 18|            90| 87634|            79| 18750|0.63394785|\n|4950428| 74.96.189.193|112|            55| 74129|            31| 54179| 0.6264269|\n|5286294|96.232.170.184| 15|            46| 91927|            33| 85149|0.62566894|\n+-------+--------------+---+--------------+------+--------------+------+----------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;desc&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-12-b960ad5c2e33&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\">#predictions with boats having more than 5 total views</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> predictions_test <span class=\"ansiyellow\">=</span> model<span class=\"ansiyellow\">.</span>transform<span class=\"ansiyellow\">(</span>test<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 3</span><span class=\"ansiyellow\"> </span>predictions_test <span class=\"ansiyellow\">=</span> predictions_test<span class=\"ansiyellow\">.</span>na<span class=\"ansiyellow\">.</span>drop<span class=\"ansiyellow\">(</span>subset<span class=\"ansiyellow\">=</span><span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&quot;prediction&quot;</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>filter<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;tot_prod_views &gt;=5&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>sort<span class=\"ansiyellow\">(</span>desc<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;prediction&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> predictions_test<span class=\"ansiyellow\">.</span>show<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;desc&apos; is not defined</div>","workflows":[],"startTime":1493901654865,"submitTime":1493901654856,"finishTime":1493901664735,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"95d88be0-a7a3-47f8-9937-703e09b663c0"}],"dashboards":[],"guid":"c769d52c-a923-4bea-866e-3eab921b9ff6","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
